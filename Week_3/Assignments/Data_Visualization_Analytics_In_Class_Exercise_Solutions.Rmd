---
title: "Data_Visualization_Analytics_In_Class_Exercise_Solutions"
output: pdf_document
date: "2025-06-27"
---

1) Create a data frame of random data containing the following columns:

- Sex: Sex should have two levels "Male" and "Female".
- Age: Age should be normally distributed with a minimum of 18 and maximum of 85 with a mean of 50 and a standard deviaiton of 10. 
- Platelet_Count: Platelet count should be bound between 1.35 and 3.71 (this is in billion/L). Make sure you round the resulting values to two decimal places! Check out the function `runif()` to help you generate these values. 

Once you have created this data frame, generate a box plot of platelet count values by sex. Make sure you label the x and y axes appropriately and add a title to the plot. 

```{r}
n = 200
Sex <- sample(c("Male","Female"),n, rep = TRUE)
Age <- pmax(18, pmin(90, round(rnorm(n, mean = 50, sd = 10))))
Platelet_Count <- round(runif(n, 1.35, 3.71),2)
dat_df <- data.frame(Sex, Age, Platelet_Count)

ggplot(dat_df, aes(x = Sex, y = Platelet_Count, fill = Sex)) +
  geom_boxplot(width = 0.25) +
  labs(x = "Sex", y = "Platelet Count (Billion/L)", title = "Platelet Count by Sex") +scale_fill_manual(values = c("#01295F", "#849324"))
```

2) Use the code above as a foundation to generate 20 different data frames with the same specifications as above. Generate summary statistics for the "Age" variable in each of the data frames. It might help you out to use the `lapply()` function. This function allows you to apply a particular function to many data frames as once. 

```{r}
my_dfs <- list()
n=200
for (i in 1:20){
  Sex <- sample(c("Male","Female"),n, rep = TRUE)
  Age <- pmax(18, pmin(90, round(rnorm(n, mean = 50, sd = 10))))
  Platelet_Count <- round(runif(n, 1.35, 3.71),2)
  
  dat_df <- data.frame(Sex, Age, Platelet_Count)
  
  my_dfs[[i]] <- dat_df
}

age_summaries <- lapply(my_dfs, function(df) summary(df$Age))
age_summaries
```

3) Using the code you generated above, generate a function that takes a continuous covariate as input and applies it to the function you used above to summarize the spread of the age variable. Apply the Platelet_Count variable to this function. 
```{r}
my_fun <- function(con_var){
  my_dfs <- list()
  n=200
  for (i in 1:20){
    Sex <- sample(c("Male","Female"),n, rep = TRUE)
    Age <- pmax(18, pmin(90, round(rnorm(n, mean = 50, sd = 10))))
    Platelet_Count <- round(runif(n, 1.35, 3.71),2)
  
    dat_df <- data.frame(Sex, Age, Platelet_Count)
  
    my_dfs[[i]] <- dat_df
  }

  age_summaries <- lapply(my_dfs, function(df) summary(df[con_var]))
}

my_fun("Age")
my_fun("Platelet_Count")
```

4) Using the function from the previous example, add a section to the function that generates a histogram of a continuous covariate of choice, Age or Platelet_Count. Save these plots to separate files.

```{r}
my_fun <- function(con_var){
  my_dfs <- list()
  n=200
  for (i in 1:20){
    Sex <- sample(c("Male","Female"),n, rep = TRUE)
    Age <- pmax(18, pmin(90, round(rnorm(n, mean = 50, sd = 10))))
    Platelet_Count <- round(runif(n, 1.35, 3.71),2)
  
    dat_df <- data.frame(Sex, Age, Platelet_Count)
  
    my_dfs[[i]] <- dat_df
    
    p <- ggplot(dat_df, aes_string(con_var)) + geom_histogram(bins = 50,fill = "skyblue")
    
    png(paste0("/Users/f002yt8/Documents/GitHub/HDS-Foundations_of_Data_Science/Week_3/figures/p-",i,".png"), width = 1500, height = 1000, res = 300)
    print(p)
    dev.off()
    i = i + 1
  }

  age_summaries <- lapply(my_dfs, function(df) summary(df[con_var]))
}

my_fun("Age")
my_fun("Platelet_Count")
```

5) 
Download the dummy_data.csv files. Each file has the same seven columns:
- Participant_ID: Unique patient identifier
- Sex: 2 levels - Male and Female
- Age: Normally distributed and bound between 18 and 85
- Socioeconomic_Status: 3 levels - Low, Medium, and High
- Disease_Status: 2 levels - Case and Control
- CReactive_Protein: Continuous variable  

Write an R script that does the following:

a) Use list.files() with pattern="\\.csv$" to find all CSV files in Data/, read them into a named list of data frames, and then rowâ€bind them into one big data frame.

b) Create a box plot with Disease_Status on the x-axis and C-Reactive Protein levels on the y-axis. Add a jitter to the box plots for the individual points. Make sure to color the box plots! Add appropriate titles and labels. 

c) Create a scatter plot of Age and CReactive_Protein. Make the "Male" points triangle and the Female points circles. Color the Cases red and the Controls blue. Make sure to add appropriate labels and titles to your graph!

```{r}
## Load packages
library(ggplot2)
library(ggpubr)
library(dplyr)

#a)
## Read all CSVs & combine
files <- list.files("/Users/f002yt8/Documents/GitHub/HDS-Foundations_of_Data_Science/Week_3/Data/In-Class-Exercises/", pattern="\\.csv$", full.names=TRUE)
dfs   <- lapply(files, read.csv)
names(dfs) <- basename(files)
all_df <- bind_rows(dfs)

dim(all_df)

#b)
ggplot(all_df, aes(x = Disease_Status, y = CReactive_Protein, fill = Disease_Status)) +
  # Box plot with slight transparency
  geom_boxplot(alpha = 0.7) +
  # Add jittered points
  geom_jitter(
    width = 0.2,  # Horizontal spread
    alpha = 0.5,  # Transparency of points
    color = "dark gray",  # Color of jittered points
    size = 2  # Size of points
  ) +
  labs(
    title = "C-Reactive Protein Levels by Disease Status",
    subtitle = "Box plot with individual data points",
    x = "Disease Status", 
    y = "C-Reactive Protein (mg/dL)"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set2") +
  # Optional: Add some statistical annotations
  stat_summary(
    fun = mean, 
    geom = "point", 
    shape = 23, 
    size = 4, 
    fill = "red"
  )

#c) 

ggplot(all_df, aes(x = Age, y = CReactive_Protein, 
                     color = Disease_Status, 
                     shape = Sex)) +
  geom_point(alpha = 0.7) +
  labs(title = "Age vs C-Reactive Protein by Disease Status and Sex",
       x = "Age", 
       y = "C-Reactive Protein (mg/dL)") +
  theme_minimal() +
  scale_color_brewer(palette = "Set1")
```



